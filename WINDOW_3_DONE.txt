ğŸ‰ çª—å£3å·²å®ŒæˆèŠå¤©åç«¯åŠŸèƒ½

âœ… äº§å‡ºç‰©ï¼š
- supabase/functions/gemini-chat/index.tsï¼ˆå«æµå¼/éŸ³é¢‘/ä¼šè¯æŒä¹…åŒ–ï¼‰
- supabase/config.tomlï¼ˆEdge Function é…ç½®ï¼‰
- supabase/functions/DEPLOYMENT.mdï¼ˆéƒ¨ç½²æŒ‡å—ï¼‰
- src/services/supabaseService.tsï¼ˆèŠå¤© APIï¼šcreateChatSession, listChatSessions, fetchMessages, sendMessageViaEdgeï¼‰
- src/types.tsï¼ˆèŠå¤©ç±»å‹ï¼šChatSession, ChatMessageDBï¼‰

ğŸ§ª åŠŸèƒ½å®ç°ï¼š
- âœ… ä¼šè¯ç®¡ç†ï¼šè‡ªåŠ¨åˆ›å»ºæ–°ä¼šè¯æˆ–å¤ç”¨ç°æœ‰ä¼šè¯
- âœ… æ¶ˆæ¯æŒä¹…åŒ–ï¼šç”¨æˆ·æ¶ˆæ¯å’Œ AI å›å¤å‡ä¿å­˜åˆ°æ•°æ®åº“
- âœ… æµå¼å“åº”ï¼šä½¿ç”¨ Server-Sent Events (SSE) æ ¼å¼å®æ—¶è¿”å› AI å›å¤
- âœ… éŸ³é¢‘è¾“å…¥ï¼šæ”¯æŒéŸ³é¢‘è½¬æ–‡æœ¬ï¼ˆå ä½å®ç°ï¼Œå¾…é›†æˆçœŸå®è½¬å†™æœåŠ¡ï¼‰
- âœ… æƒ…ç»ªæ£€æµ‹ï¼šåŸºäºå…³é”®è¯çš„ç®€å•æƒ…ç»ªè¯†åˆ«
- âœ… Persona ç³»ç»Ÿï¼šæ”¯æŒä¸‰ç§äººæ ¼ï¼ˆhealing/rational/funï¼‰çš„ç³»ç»Ÿæç¤ºè¯
- âœ… é”™è¯¯å¤„ç†ï¼šç»Ÿä¸€çš„é”™è¯¯è¿”å›æ ¼å¼å’Œæ—¥å¿—è®°å½•
- âœ… CORS æ”¯æŒï¼šå…è®¸è·¨åŸŸè¯·æ±‚

ğŸ“Œ éƒ¨ç½²è¯´æ˜ï¼š
- Edge Function ä»£ç å·²å®Œæˆï¼Œéœ€è¦é€šè¿‡ Supabase CLI æˆ– Dashboard éƒ¨ç½²
- éƒ¨ç½²å‰éœ€åœ¨ Supabase Dashboard è®¾ç½®ç¯å¢ƒå˜é‡ï¼š
  * GEMINI_API_KEY
  * SUPABASE_URL
  * SUPABASE_SERVICE_ROLE_KEY
- è¯¦ç»†éƒ¨ç½²æ­¥éª¤è§ supabase/functions/DEPLOYMENT.md

ğŸ”— API ç«¯ç‚¹ï¼š
- Edge Function URL: https://xumbiixfvumebxyrtueu.supabase.co/functions/v1/gemini-chat
- å‰ç«¯å¯é€šè¿‡ sendMessageViaEdge() å‡½æ•°è°ƒç”¨

ğŸ“ æ³¨æ„äº‹é¡¹ï¼š
1. Edge Function éœ€è¦æ‰‹åŠ¨éƒ¨ç½²åˆ° Supabaseï¼ˆCLI æˆ– Dashboardï¼‰
2. éŸ³é¢‘è½¬æ–‡æœ¬åŠŸèƒ½ä¸ºå ä½å®ç°ï¼Œéœ€è¦é›†æˆçœŸå®çš„è½¬å†™æœåŠ¡
3. æµå¼å“åº”ä½¿ç”¨ SSE æ ¼å¼ï¼Œå‰ç«¯éœ€ä½¿ç”¨ ReadableStream æ¶ˆè´¹
4. ä¼šè¯ ID åœ¨é¦–æ¬¡è°ƒç”¨åé€šè¿‡å“åº”å¤´ X-Session-Id è¿”å›
5. å‰ç«¯è‡ªåŠ¨é€šè¿‡ x-user-id è¯·æ±‚å¤´ä¼ é€’ç”¨æˆ· ID

ğŸ¯ åç»­æ­¥éª¤ï¼š
1. éƒ¨ç½² Edge Function åˆ° Supabase
2. æµ‹è¯•æµå¼å“åº”å’Œä¼šè¯ç®¡ç†
3. é›†æˆçœŸå®çš„éŸ³é¢‘è½¬æ–‡æœ¬æœåŠ¡ï¼ˆå¯é€‰ï¼‰
4. å‰ç«¯é›†æˆèŠå¤©åŠŸèƒ½ï¼ˆChat.tsx é¡µé¢ï¼‰

ğŸ“š ç›¸å…³æ–‡æ¡£ï¼š
- éƒ¨ç½²æŒ‡å—ï¼šsupabase/functions/DEPLOYMENT.md
- ä»»åŠ¡æ–‡æ¡£ï¼šdocs/tasks/WINDOW_3_CHAT_BACKEND.md
- å‰ç«¯æœåŠ¡å±‚ï¼šsrc/services/supabaseService.ts
